# Настройка Telegram Mini App для TG Life

Это руководство поможет вам настроить Telegram Mini App для вашего проекта TG Life.

## Шаг 1: Создание бота в Telegram

1. Откройте Telegram и найдите бота @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания нового бота
4. После создания бота, BotFather выдаст вам токен бота (BOT_TOKEN). Сохраните его для дальнейшего использования.

## Шаг 2: Настройка Mini App в BotFather

1. Отправьте команду `/mybots` боту @BotFather
2. Выберите вашего бота из списка
3. Нажмите на "Bot Settings" > "Menu Button" > "Configure menu button"
4. Установите URL вашего веб-приложения (которое вы получите на шаге 4)

## Шаг 3: Установка зависимостей

```bash
npm install telegraf dotenv cors
```

## Шаг 4: Бесплатный хостинг на Glitch

1. Зайдите на сайт [Glitch](https://glitch.com/) и создайте аккаунт (если у вас его еще нет)
2. Создайте новый проект, выбрав "New Project" > "Import from GitHub"
3. Если у вас есть репозиторий на GitHub, укажите его URL
4. Если нет, выберите "hello-express" и затем загрузите файлы вашего проекта через Glitch-консоль

### Альтернативный вариант: загрузка файлов через Glitch-консоль

1. Создайте новый проект на Glitch, выбрав "New Project" > "hello-express"
2. Откройте консоль Glitch (Tools > Terminal)
3. Выполните следующие команды для очистки проекта:
   ```bash
   rm -rf ./*
   ```
4. Затем скопируйте все файлы из вашего локального проекта в проект на Glitch

## Шаг 5: Настройка переменных окружения

1. В проекте Glitch найдите файл `.env` или создайте его
2. Добавьте следующие переменные:
   ```
   BOT_TOKEN=ваш_токен_бота_от_BotFather
   WEBAPP_URL=https://ваш-проект.glitch.me
   PORT=3000
   ```

## Шаг 6: Запуск бота и сервера

1. В консоли Glitch выполните:
   ```bash
   npm install
   npm start
   ```
2. Ваш бот и сервер должны запуститься. URL вашего приложения будет: `https://ваш-проект.glitch.me`

## Шаг 7: Настройка Webhook для бота (опционально)

Если вы хотите, чтобы ваш бот работал через webhook вместо long polling:

1. Добавьте в `.env` файл:
   ```
   WEBHOOK_PATH=/webhook
   ```
2. Измените код в `bot.js`, чтобы использовать webhook вместо `bot.launch()`

## Поддержание работы Glitch

Glitch бесплатно предоставляет хостинг, но проекты "засыпают" после 1 часа неактивности. Для поддержания работы:

1. Создайте файл `keep-alive.js` с кодом, который будет периодически отправлять запросы к вашему приложению
2. Используйте сервис [UptimeRobot](https://uptimerobot.com/) для мониторинга вашего URL

## Тестирование

1. Найдите вашего бота в Telegram и отправьте команду `/start`
2. Нажмите на кнопку, которая откроет ваше Mini App
3. Убедитесь, что приложение работает корректно

## Устранение неполадок

- Если бот не отвечает, проверьте токен бота в `.env` файле
- Если Mini App не открывается, проверьте URL в `.env` файле и настройках BotFather
- Проверьте логи в консоли Glitch для выявления ошибок
